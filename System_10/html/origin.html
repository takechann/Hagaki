<!DOCTYPE html>
<html lang="ja">
<head>
 <meta charset="utf-8">
<style>

</style>
 <title>連名の選択</title>
 <link rel="stylesheet" type="text/css" href="../css/botn.css">
  <style type="text/css">
  
  .submit_file_open{
	color:#666666;
    background: #E4E4E4;
    border: 1px solid #CCCCCC;
    font-size: 116%;
    padding: 10px 30px;
    width: 200px;
    display: block;
    text-align: center;
    font-weight: bold;
    text-decoration: none;
	-webkit-border-radius: 5px;
-moz-border-radius: 5px;
  }
  

  
  </style>
 
 <script type="text/javascript">
 <!--
			// window.resizeTo(800,600);
            // Excelを操作するために必要
            var excel = new ActiveXObject("Excel.Application");
            // 初期化処理
            function fileOpen() {
                // 画面からの入力値を取得
                var file = document.getElementById("file").value;
                // 画面を描画
                document.open();
                document.write("<!DOCTYPE html><html lang='ja'>");
                document.write("<head><meta charset='utf-8'>");
                document.write("<style>table, th, td {  border: 1px solid;}</style>");
                document.write("<title>宛名面の印刷</title>");
                document.write("<script src='../js/encoding.min.js'></script>");
                document.write("<script src='../js/encoding.min2.js'></script>");
                document.write("<script src='../js/print.js'></script>");
                document.write("<body style='background-color:#DAFFE7'></body>");
                document.write("<a href='#' id='download' download='園児宛名情報.csv'><input type='button' style='background-color:#F2D8DF;' value='保存'></a>");
                document.write("<input type='button' style='background-color:#fffafa;' value='全員送る' onclick='AllSend()'>");
                document.write("<input type='button' style='background-color:#fffafa;' value='全員送らない' onclick='AllNotSend()'>");
                document.write("<input type='button' style='background-color:#fffafa;' value='函館市近郊にのみ送る' onclick='AllNotSend(); hakodate()'>");
				document.write("<form name='chbox'>")
				document.write("<input type='checkbox' style='background-color:#fffafa;' value='サンプル1'>1年生<br>");
				document.write("<input type='checkbox' style='background-color:#fffafa;' value='サンプル2'>2年生<br>");
				document.write("<input type='checkbox' style='background-color:#fffafa;' value='サンプル3'>3年生<br>");
				document.write("<input type='checkbox' style='background-color:#fffafa;' value='サンプル4'>4年生<br>");
				document.write("<input type='checkbox' style='background-color:#fffafa;' value='サンプル5'>5年生<br>");
				document.write("<input type='checkbox' style='background-color:#fffafa;' value='サンプル6'>6年生<br>");
				document.write("<input type='button' value='変更' onclick='boxCheck()'>")
				document.write("</form>")
                document.write("<input type='button' style='background-color:#fffafa;' value='ホームへ戻る' class='header_right' onClick='home()'>");
                document.write("<br><font size=4>データファイルを選択して、印刷ボタンを押下してください</font></br><table border='0'>");	
                document.write("<tr><td>データファイル：</td><td><input type='file' id='filename' size='80' /></td>");
                document.write("<td><button onclick='printDoc();'>印刷</button></td></tr></table>");
				// ブックを開く
                var workBook = excel.Workbooks.Open("C:/Users/so02120/Downloads/Hagaki-master(1)/Hagaki-master/System_9/master3_1.csv");
 
                // シートは一番左のシートで固定
                var workSheet = workBook.Sheets(1);
 
                // 1行目の出力（1行目に値が存在している列までを対象に出力）

                document.write("<body><table id='tbl'><tr>");
                document.write("<td valign='top'><table id='tbl0'><tr>");

                var max_col = 1;
                while (1) {
                    var cell = workSheet.Cells(1, max_col);
                    // 対象セルの値が無い場合は処理を抜ける
                    if (cell == null || cell.Value == undefined)
                        break;
                    // 値を出力する
                    document.write("<th style='text-align: center;'>" + cell.Value + "</th>");
                    // 次の列の値へ
                    max_col++;
                }
                document.write("</tr>");
                // 2行目以降の出力（1列目に値が存在している行までを対象に出力）
                var max_row = 2;
                while (1) {
                    var cell = workSheet.Cells(max_row, 1);
                    // 対象セルの値が無い場合は処理を抜ける
                    if (cell == null || cell.Value == undefined)
                        break;
                    // 1行目の最終列までを対象に値を出力する
                    document.write("<tr>");
                    for ( i = 1; i < max_col; i++) {
                        cell = workSheet.Cells(max_row, i);
                        document.write("<td>" + cell.Value + "</td>");
                    }
                        document.write("<td><input type='button' style='background-color:#fffafa;' value='<->' onclick='movRow(this)'></td>");
                    document.write("</tr>");
                    // 次の行へ
                    max_row++;
                }
                document.write("</table>");
                document.write("<td valign='top'><table id='tbl1'><tr>");
                document.write("<th style='text-align: center;'>姓</th>");
                document.write("<th style='text-align: center;'>名</th>");
                document.write("<th style='text-align: center;'>郵便番号</th>");
                document.write("<th style='text-align: center;'>住所</th>");
                document.write("<th style='text-align: center;'>誕生日</th>");
                document.write("<th style='text-align: center;'>年齢</th>");
                document.write("<th style='text-align: center;'>学年</th>");
                document.write("<th style='text-align: center;'>敬称</th></tr>");
                document.write("</table></td></tr></table></body></html>");
                document.close();

                
                // Excelファイルを閉じる
                workBook.Close();
            }

-->

  </script>

    </head>
	
    <body style='background-color:#DAFFE7'>
	
	<div align='CENTER'><input type='button' style='background-color:#fffafa;' value='連盟有り' id='file' class='submit_file_open' onclick='fileOpen()'></div>
	<div align='CENTER'><input type='button' style='background-color:#fffafa;' value='連盟無し' id='file' class='submit_file_open' onclick='fileOpen()'></div>
	<div align='CENTER'><input type="button" style='background-color:#fffafa;' value="ホームへ戻る" onClick="location.href='botn.html'"></div>
	
	</body>
</html>

